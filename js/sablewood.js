// Sablewood detail data
const sablewoodDetails = {
    sablewood: {
        title: "The Sablewood",
        description: "The Sablewood is an ancient, expansive forest of trees that reach hundreds of feet into the air. Rumored to be older than the Forgotten Gods, this dense wood is widely known throughout the Mortal Realm, and many who visit are surprised to learn that the stories they believed were exaggerated legends are, in fact, stark truths.",
        finds: []
    },
    verdance: {
        title: "Endless Verdance",
        description: "As far as the eye can see in all directions, and farther still, there is an endless verdancy. The canopy is so thick that, often, travelers cannot tell if it is day or night, and must be careful not to lose their path. Anyone that moves through the treetops could easily make it from one edge of the Sablewood to the other without touching the forest floor.",
        finds: [
            "An entire village taken over by Hunting Trees in the night, now abandoned.",
            "The deafening whispers of a thousand leaves rustling in the wind.",
            "The scent of sweet honey-like sap leaking from between the cracks of a sablewood tree."
        ]
    },
    fauna: {
        title: "Hybrid Fauna",
        description: "The fauna of the Sablewood are never quite what unseasoned travelers expect. Always a blend of two familiar beasts, or even animals and elements, they operate in unfamiliar ways. These creatures range from docile and friendly to territorial and aggressive. Many are larger than might be expected, by virtue of their profoundly long lives.",
        finds: [
            "Tiny cat-squirrels jumping from limb to limb as massive giraffe-deer move gingerly along the forest floor.",
            "The hooting-howl of strixwolves calling in the night.",
            "The whoosh of air passing over you as a lemur-toad swings by in the darkness."
        ]
    },
    spires: {
        title: "The Spires",
        description: "Within the Sablewood there are a number of Spires with attendants that take up the position any time the previous tower tender dies, causing their signal fire to extinguish. To become a Spire Keeper, one must run through the woods, off all known paths, and make it to the unattended Spire to light the signal fire. No one knows the true job of these Keepers, only that someone must always reside in each tower within the forest.",
        finds: [
            "Twisting towers of stone that reach beyond the canopy of the Sablewood.",
            "The soft clatter of Spire stones falling from great heights to rest among the undergrowth.",
            "The ozone smell of powerful magic."
        ]
    },
    pathways: {
        title: "Well-Worn Pathways",
        description: "The pathways of the Sablewood are worn so deep that they are sunken into the rich soil of the forest undergrowth. People who live on the edge of the woods will warn travelers not to leave the paths, as those who do never return and their bodies are never found. Maps leading through the Sablewood are handed down through generations and are quite costly to acquire.",
        finds: [
            "New travelers walking with their heads and eyes down, while experienced merchants whistle common tunes.",
            "The creak of wooden cart wheels passing over packed dirt.",
            "The smell of campfire as strangers crowd together to scare away the darkness."
        ]
    },
    "titans-steps": {
        title: "The Titan's Steps",
        description: "Stories say that in the time of the Earliest Age, there was a fight between the Old and the New gods in the place where the Sablewood now grows. During this battle, numerous portions of the Mortal Realm were razed, and others were crafted afresh. One such craft is known as the Titan's Steps, or the Pillars of the Sablewood, that stand within the forest at a variety of incredible heights. The rocky cliffs of the formation stop neither plants nor creatures from climbing their height. Wooden structures old and new cling to the rock with nets strung between pillars like cobwebs.",
        finds: [
            "Giant Mountain Crabs camouflaging themselves as rock, waiting to strike unwary climbers.",
            "The Catcher's Cradles - nets strung below walkways to catch those who fall.",
            "Duskwatch Outpost, the largest encampment hanging from the edges of the Steps."
        ]
    },
    "lucent-river": {
        title: "The Lucent River",
        description: "The Lucent River cuts a luminous ribbon through the Sablewood, at parts deep and clear and other parts rocky and tumultuous. It is the primary source of fresh water in the area. The common mythology describes the river as the everflowing tears of the Forgotten Gods. The waters are famed for their healing ability, likely due to their moonglow - the soft blue glow it gives off when the moon rises.",
        finds: [
            "Riverboats pulled by craymeleons (chameleon-crayfish hybrids) scurrying along the shore.",
            "Eeligators sleeping in the deepest portions, ready to strike.",
            "The High Falls with its massive cavern containing a carved stone throne."
        ]
    },
    "open-vale": {
        title: "The Open Vale",
        description: "A perfect clearing within the middle of the Sablewood; no one knows why the trees will not grow here. It is covered in a layer of particularly lush grass and receives complete sun, in comparison to the rest of the thick forest. The Open Vale is the site of numerous spiritual rituals, performed by a variety of communities. 'The Meadow Demands Peace' is a common phrase, and fighting within the bounds of the Vale is punishable by banishment.",
        finds: [
            "Standing stones dedicated to the Forgotten Gods marking the edges, rumored to glow with soft blue light.",
            "The perpetual Miremist fog that contains its own weather system.",
            "Sunfire Lilies that bloom once a year for eight days."
        ]
    },
    hush: {
        title: "Hush",
        description: "The small village of Hush sits nestled into the heart of Sablewood. It's quaint and quiet, renowned for its friendly residents who are accustomed to providing room, board, food, and drink for any travelers and merchants who need a place to stop off during their journey. Wards maintained by the Whitefire Arcanist keep the most dangerous animals from disturbing anyone residing within the four dwarven-stone pillars marking the corners of town.",
        finds: [
            "Clover's Tavern, a massive six-story tavern built around the trunk of an ancient tree.",
            "The Sunless Farms where crops grow in symbiosis with dark blue-green moss.",
            "Guest privileges - travelers taken in by families for three nights with their needs prioritized."
        ]
    },
    refuge: {
        title: "The Refuge",
        description: "The first stop before entering the Sablewood from the east, or the last grateful stop for those who've made their way out. This community considers itself to be the last bastion of 'civilization' before entering the wilds. The large town is walled on all sides, and the townsfolk are forbidden from entering the Sablewood. Firewatchers burn the edges of the Sablewood to keep it from growing beyond its bounds.",
        finds: [
            "The Fire Walk - a yearly festival where initiates walk through a massive pyre of sablewood.",
            "Fly fishing from watchtowers, catching rabbit-gliders, moth-possums, and turtle-mice.",
            "The Ash Quarry where charred Sablewood is claimed and sold as remedy."
        ]
    },
    "roots-hollow": {
        title: "Root's Hollow",
        description: "A thriving Underroot community carved into the roots of the northern sablewood trees. Root's Hollow is one of the few known villages within the inhospitable forest, and though it is hard to get to, it is famed for its size. Few merchants know the locations of the hidden doors within the trees, but those that do make a fortune trafficking specialized potions and medicines from the Root's Hollow apothecaries.",
        finds: [
            "The Sable Stills where sable sap is fermented into powerful potions and healing concoctions.",
            "The Latch - a mysterious elevator leading deeper underground, accessible only to the Village Council.",
            "Knock Wood communication system using tree roots to relay complex messages."
        ]
    },
    thistlefolk: {
        title: "Thistlefolk",
        description: "The Thistlefolk take up residence in the place where nobody else daresâ€”within the thickest, thorniest bramble of the Sablewood. They are known for wearing armored clothing made up of thousands of tiny polished stones that have been cut to fit together seamlessly, like scales. Because the only Thistlefolk who emerge are often thieves, they have a reputation for being criminals. In actuality, most are quite peaceful, choosing to live within the safety of the bramble for protection.",
        finds: [
            "Eclectic villages painted in bright hues and large murals, lit by bioluminescent moss.",
            "The Wandering Briar - a living thicket that crawls through the forest, home to traveling Thistlefolk.",
            "Stone tumblers along the Lucent River where they polish stones for their armor."
        ]
    },
    "sable-sinecure": {
        title: "The Sable Sinecure",
        description: "This merchant's guild effectively runs the Sablewood. They closely guard their territory and will protect any traveler that walks the forest paths. The Sable Sinecure got their name from years of joking by the fireside: 'To make such a dangerous job, that so few can accomplish, look easy? Well that's just a walk in the woods!' They are the only merchants willing to transport goods up the Titan's Steps.",
        finds: [
            "Fire-falcons - cousin to the phoenix, used by merchants to fly ahead and signal danger.",
            "Secret caches throughout the forest protected by hidden traps.",
            "Wood Wage - a phrase asking the cost of something that quantifies the danger it took to acquire."
        ]
    }
};

// Open detail popup
function openDetail(detailKey) {
    const detail = sablewoodDetails[detailKey];
    if (!detail) return;

    const popup = document.getElementById('detailPopup');
    const title = document.getElementById('detailTitle');
    const description = document.getElementById('detailDescription');
    const findsList = document.getElementById('findsList');
    const findsContainer = document.getElementById('detailFinds');

    title.textContent = detail.title;
    description.textContent = detail.description;
    
    // Clear and populate finds list
    findsList.innerHTML = '';
    if (detail.finds && detail.finds.length > 0) {
        findsContainer.style.display = 'block';
        detail.finds.forEach(find => {
            const li = document.createElement('li');
            li.textContent = find;
            findsList.appendChild(li);
        });
    } else {
        findsContainer.style.display = 'none';
    }

    popup.style.display = 'block';
}

// Close detail popup
function closeDetail() {
    document.getElementById('detailPopup').style.display = 'none';
}

// Event listeners for nodes
document.querySelectorAll('.node').forEach(node => {
    node.addEventListener('click', () => {
        const detailKey = node.getAttribute('data-detail');
        openDetail(detailKey);
    });
});

// Close button
document.getElementById('closeDetail').addEventListener('click', closeDetail);

// Close when clicking outside
window.addEventListener('click', (e) => {
    if (e.target.id === 'detailPopup') {
        closeDetail();
    }
});

// Escape key to close
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
        closeDetail();
    }
});

// Continue button
document.getElementById('continueBtn').addEventListener('click', () => {
    console.log('Continuing to character selection...');
});